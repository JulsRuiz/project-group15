CREATE VIEW BirthWeight AS
	SELECT goat_id, CAST(alpha_value as float) as weight
	FROM Trait
	WHERE trait_code = '357' AND NOT alpha_value = '0.0' AND NOT alpha_value = '-1';

CREATE VIEW BirthYear AS
	SELECT goat_id, EXTRACT('Year' FROM dob) AS Year
	FROM Goat;

CREATE VIEW averages AS
	SELECT Year, ROUND(AVG(weight):: numeric, 3) AS average_birthweight
	FROM BirthWeight JOIN BirthYear ON BirthWeight.goat_id = BirthYear.goat_id
	GROUP BY Year
	ORDER BY Year;


